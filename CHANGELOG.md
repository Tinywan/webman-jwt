# ChangeLog

所有重要的项目变更都会记录在此文件中。

本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [v1.12.0] - 2024-12-31

### ✨ 新增功能
- 新增 `RedisConnectionException` 异常类，专门处理Redis连接问题
- 新增 `handleSingleDeviceToken()` 公共方法，统一处理单设备登录逻辑
- 新增 `validateRedisParams()` 参数验证方法，提高代码复用性
- 新增 `RedisHandler::isAvailable()` 方法，检查Redis可用性
- 增强单元测试，添加边界条件和异常情况测试

### 🔧 优化改进
- **Redis错误处理优化**: 完善Redis连接检查和异常捕获机制
- **代码重复提取**: 从3处重复代码减少到1个公共方法，减少约30行重复代码
- **参数验证统一化**: 统一TTL和token参数验证逻辑
- **键名生成优化**: 新增 `generateKey()` 方法，统一键名生成逻辑
- **安全执行机制**: 新增 `safeExecute()` 方法，统一Redis操作错误处理

### 🐛 问题修复
- 修复Redis连接失败时的错误处理
- 修复参数验证不完善的问题
- 修复单设备登录逻辑中的潜在问题

### 📝 文档改进
- 完善PHPDoc注释，提高代码可读性
- 优化参数和返回值的详细描述
- 增强异常情况的说明

### 🔄 兼容性
- 保持PHP 7.1+版本兼容性
- 保持向后兼容性，不影响现有API
- 所有现有功能保持不变

### 📊 统计信息
- **4个文件** 被修改
- **240行** 新增代码
- **36行** 删除代码
- **1个新文件** 创建

---

## [v1.11.0] - 2024-12-30

### 🔧 问题修复
- 修复ES系列和PS系列算法无法正常使用的问题
- 修正注释，仅提示已支持的算法

### 📝 文档改进
- 更新README文档，优化算法说明

---

## [v1.10.0] - 2024-12-29

### 🔧 问题修复
- 修复token参数隐式可空类型问题，避免弃用警告
- 关闭默认支持get请求获取令牌功能

### ✨ 新增功能
- 增加GET方式获取令牌的支持
- 添加令牌过期错误码定义

---

## [v1.9.0] - 2024-12-28

### 🔧 问题修复
- 修复获取当前用户信息返回类型问题，支持数组和对象返回

---

## [v1.8.0] - 2024-12-27

### ✨ 新增功能
- 初始版本发布
- 支持多种JWT签名算法
- 支持单设备登录
- 支持Redis缓存
- 完整的令牌生命周期管理

### 🎯 核心特性
- JSON Web Token (JWT) 认证
- 支持对称和非对称加密算法
- access_token + refresh_token 双令牌机制
- 多客户端支持（WEB、MOBILE、APP等）
- Redis缓存管理
- 完善的错误处理机制

---

## 版本说明

### 版本号规则
- **主版本号**: 当有不兼容的API修改时
- **次版本号**: 当添加向下兼容的功能时
- **修订号**: 当进行向下兼容的问题修复时

### 更新日志格式
- **✨ 新增功能**: 新的功能特性
- **🔧 优化改进**: 现有功能的优化
- **🐛 问题修复**: 问题的修复
- **📝 文档改进**: 文档的更新和改进
- **🔄 兼容性**: 兼容性相关说明
- **📊 统计信息**: 代码变更统计

### 贡献指南
如果您想要贡献代码，请确保：
1. 遵循现有的代码风格
2. 添加适当的测试用例
3. 更新相关文档
4. 遵循语义化版本规范

### 📄 许可证
本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件